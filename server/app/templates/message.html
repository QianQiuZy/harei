<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://qianqiuzy-1313476938.cos.ap-shanghai.myqcloud.com/32x32.png" sizes="32x32" type="image/png">
    <link rel="icon" href="https://qianqiuzy-1313476938.cos.ap-shanghai.myqcloud.com/16x16.png" sizes="16x16" type="image/png">
    <link rel="stylesheet" href="{{ url_for('static', filename='CSS/message.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='CSS/sidebar.css') }}">
    <title>花礼的提问箱</title>
</head>
<body>
    <div id="overlay" class="overlay"></div>
    <div class="background-layer" style="background-image: url('https://qianqiuzy-1313476938.cos.ap-shanghai.myqcloud.com/harei-back.jpg');"></div>
    <div id="host-sidebar-container"></div>
    <div class="main-content">
        <div class="profile-section">
            <div class="container">
                <!-- 新增TAG筛选下拉框 -->
                <div class="filter-bar">
                    <label for="filter-tag">筛选标签：</label>
                    <select id="filter-tag">
                        <option value="">全部</option>
                    </select>
                </div>
                <!-- 左侧会话列表 -->
                <div class="chat-list">
                    {% for chat in chat_data %}
                        <li><a href="#" class="chat-link" data-id="{{ chat.id }}">{{ chat.id }} - {{ chat.date }}</a></li>
                    {% endfor %}
                </div>
        
                <!-- 右侧会话内容 -->
                <div class="chat-content">
                    {% for chat in chat_data %}
                        <div id="chat-{{ chat.id }}" class="chat-box" data-tag="{{ chat.tag }}" style="display: none;">
                            <h2>{{ chat.date }}</h2>
                            <pre class="chatmsg">
{% set formatted_msg = chat.msg | replace("{{", "<span class='hidden-text'>") | replace("}}", "</span>") %}
{{ formatted_msg | safe }}
                            </pre>
                            <!-- 遍历显示留言关联的图片 -->
                            <div class="thumbnail-container">
                                {% for image_url in chat.images %}
                                    <img src="{{ image_url }}" alt="缩略图" class="thumbnail" data-full-image="{{ image_url }}">
                                {% endfor %}
                            </div>
                        </div>
                    {% endfor %}
                    <!-- 图片查看弹窗，增加上一张、下一张和关闭按钮 -->
                    <div class="image-modal" style="display: none;">
                        <div class="modal-content">
                            <button id="prev-btn" class="nav-btn">上一张</button>
                            <button id="next-btn" class="nav-btn">下一张</button>
                            <button id="close-btn" class="nav-btn">关闭</button>
                            <img id="modal-img" src="" alt="Large Image">
                        </div>
                    </div>
                </div>
            </div>
            <button class="archive-all-button">一键归档已审核消息</button>
        </div>
    </div>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    <script src="{{ url_for('static', filename='js/message.js') }}"></script>
</body>
</html>
